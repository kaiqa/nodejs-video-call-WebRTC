<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script>
    const ROOM_ID = "<%= roomId %>"

  </script>
  <!--
  <script defer src="https://unpkg.com/peerjs@1.2.0/dist/peerjs.min.js"></script>
  -->
  <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
  <script src="/socket.io/socket.io.js" defer></script>
 <!-- 
 <script defer src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.2/socket.io.min.js"></script>
-->
  <script src="script.js" defer></script>
  <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
   
 
  <script type="text/javascript" src="jquery.qrcode.min.js"></script>
  
  <title>Document</title>
  <style>
    #video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, 300px);
      grid-auto-rows: 300px;
      background-color: gray;
      }
    
    video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      background-color: gray;
    }
  </style>
</head>
<body>
  <div id="video-grid">
    
  </div>

  <button class="play">Play</button>

 
  <p id="href"></p>
  
  <p>QR code with link to room: </p>
  <div id="qrcode"></div>
<!-- 
  <p>Render in table</p>
  <div id="qrcodeTable"></div>
  <p>Render in canvas</p>
  <div id="qrcodeCanvas"></div>
-->
  <script>
    document.getElementById("href").innerHTML ="URL of this room: <br>" + window.location.href;
    qrUri = document.getElementById("href").innerHTML = window.location.href;
    jQuery('#qrcode').qrcode(qrUri);

   /*
    jQuery(document).ready(function ($) {
  // Center Play Button Onclick 
  $('button.play').click(function () {
    var play_button = $(this);
    var video = $(this).parent().find('video').get(0);
       if (!video) {
        const myVideo = document.createElement('video');        
        myVideo.muted = true
        alert (video);
        let peers = {}
        alert ("no video .. creating video"); 
       
        navigator.mediaDevices.getUserMedia({
          video: true,
          audio: true
              })
              .then(stream => {
                addVideoStream(myVideo, stream)
              })
        var video = $(this).parent().find('video').get(0);
        alert (video);
        //alert ("video created");   
        console.log("no video");      
      
        } else {
        console.log("yes video");  
          video.play();
          play_button.hide();
       }
       return false;
    });

});


/*
	  jQuery('#qrcodeTable').qrcode({
		  render	: "table",
		  text	: "http://jetienne.com"
	  });	
    
    jQuery('#qrcodeCanvas').qrcode({
		  text	: "http://jetienne.com"
	  });	
*/  
    </script>
</body>
</html>